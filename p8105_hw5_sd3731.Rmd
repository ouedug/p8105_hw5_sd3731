---
title: "p8105_hw5_sd3731"
author: "Susie Dong"
date: "2023-11-13"
output: github_document
---

```{r, message=FALSE}
library(tidyverse)
library(dplyr)

knitr::opts_chunk$set(
	warning = FALSE,
	message = FALSE,
	fig.width = 8, 
	fig.height = 6)

theme_set(theme_minimal())
```

## Problem 1

### Accessing and Describing the Data

1. Load the Data
```{r, message=FALSE}
homicide = read_csv("./data/homicide-data.csv")
```

2. Inspect the Data
The `homicide` dataset includes data on homicide incidents in the United States spanning from 2007 to 2017. It is comprised of `r nrow(homicide)` rows and `r ncol(homicide)` columns.

**Variables**:

- `uid`: unique identifier

- `reported_date`: date of homicide accident

- `victim_last`: last name of victim

- `victim_first`: first name of victim

- `victim_race`: race name of victim

- `victim_age`: age name of victim

- `victim_sex`: sex name of victim

- `city`: city location of homicide accident

- `state`: state location of homicide accident

- `lat`: latitude location of homicide accident

- `lon`: longitude location of homicide accident

- `disposition`: disposition outcome of homicide accident

### Data Manipulation

```{r}
homicide = homicide|>
  mutate(
    city_state = str_c(city, ", ", state)
    )

homicide |> 
        group_by(city) |>
        summarise(count = n()) |>
        knitr::kable(caption = "Total number of homicides")

unsolved_label = c("Closed without arrest", "Open/No arrest")
homicide |>
        filter(disposition %in% unsolved_label) |>
        group_by(city) |>
        summarise(unsolved_count = n()) |>
        knitr::kable(caption = "Total number of unsolved homicides")
    
```



```{r}
homicide |> 
  count(city_state)

homicide |> 
  filter(str_detect(disposition, "Open|without")) |> 
  count(city_state)

homicide_Baltimore <-
  homicide |> 
  filter(city_state == "Baltimore, MD")|> 
  count(disposition)

prop_res <- 
  prop.test(x = homicide_Baltimore$n[[2]] + homicide_Baltimore$n[[3]], 
          n = sum(homicide_Baltimore$n), 
          p = 0.5) |> 
  broom::tidy()

prop_res |> 
  pull(estimate, conf.low)
```

## R Markdown


